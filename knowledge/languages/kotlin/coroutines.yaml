# Kotlin Coroutines Knowledge Base

suspend_function:
  description: "Kotlin Suspend Function"
  context: "Coroutine context"
  icon: "â¸ï¸"
  
  patterns:
    - pattern: 'suspend\s+fun\s+(?P<name>\w+)'
      type: "declaration"
    - pattern: 'suspend\s+override\s+fun\s+(?P<name>\w+)'
      type: "override"


coroutine_scope:
  description: "Coroutine Scope"
  icon: "ğŸ”„"
  
  scopes:
    GlobalScope:
      description: "å…¨å±€ä½œç”¨åŸŸï¼Œç”Ÿå‘½å‘¨æœŸä¸åº”ç”¨ç›¸åŒ"
      warning: "é¿å…ä½¿ç”¨ï¼Œå¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼"
    
    viewModelScope:
      description: "ViewModel ä½œç”¨åŸŸ"
      lifecycle: "ViewModel cleared æ—¶è‡ªåŠ¨å–æ¶ˆ"
      import: "androidx.lifecycle.viewModelScope"
    
    lifecycleScope:
      description: "Lifecycle ä½œç”¨åŸŸ"
      lifecycle: "Lifecycle destroyed æ—¶è‡ªåŠ¨å–æ¶ˆ"
      import: "androidx.lifecycle.lifecycleScope"
    
    MainScope:
      description: "ä¸»çº¿ç¨‹ä½œç”¨åŸŸ"
      dispatcher: "Dispatchers.Main"
    
    CoroutineScope:
      description: "è‡ªå®šä¹‰ä½œç”¨åŸŸ"
      pattern: 'CoroutineScope\s*\(\s*(?P<context>[^)]+)\s*\)'


launch:
  description: "Launch Coroutine Builder"
  context: "Fire-and-forget"
  icon: "ğŸš€"
  
  bind_patterns:
    - pattern: '(?P<scope>\w+)\.launch\s*\('
      handler_group: "block"
    - pattern: 'launch\s*\{\s*'
      handler_group: "block"
  
  parameters:
    context:
      description: "Coroutine context"
      optional: true
    start:
      description: "Start mode"
      values: ["DEFAULT", "LAZY", "ATOMIC", "UNDISPATCHED"]
  
  returns: "Job"


async:
  description: "Async Coroutine Builder"
  context: "Returns Deferred with result"
  icon: "â³"
  
  bind_patterns:
    - pattern: '(?P<scope>\w+)\.async\s*\('
      handler_group: "block"
    - pattern: 'async\s*\{\s*'
      handler_group: "block"
  
  returns: "Deferred<T>"
  
  await_pattern: '(?P<deferred>\w+)\.await\s*\(\s*\)'


withContext:
  description: "Context Switch"
  context: "Switches coroutine context"
  icon: "ğŸ”€"
  
  pattern: 'withContext\s*\(\s*(?P<context>[^)]+)\s*\)\s*\{'
  
  common_contexts:
    - "Dispatchers.Main"
    - "Dispatchers.IO"
    - "Dispatchers.Default"
    - "Dispatchers.Unconfined"


dispatchers:
  description: "Kotlin Dispatchers"
  
  types:
    Main:
      description: "Android ä¸»çº¿ç¨‹"
      can_update_ui: true
      use_case: "UI æ“ä½œ"
    
    IO:
      description: "IO å¯†é›†å‹çº¿ç¨‹æ± "
      thread_pool: "Unbounded"
      use_case: "ç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶è¯»å†™ã€æ•°æ®åº“æ“ä½œ"
    
    Default:
      description: "CPU å¯†é›†å‹çº¿ç¨‹æ± "
      thread_pool: "CPU cores"
      use_case: "å¤æ‚è®¡ç®—ã€æ•°æ®å¤„ç†"
    
    Unconfined:
      description: "ä¸é™å®šçº¿ç¨‹"
      warning: "é€šå¸¸åªç”¨äºæµ‹è¯•"


flow:
  description: "Kotlin Flow"
  icon: "ğŸŒŠ"
  
  creation_patterns:
    - pattern: 'flow\s*\{'
      type: "cold_flow"
    - pattern: 'flowOf\s*\('
      type: "immediate"
    - pattern: 'asFlow\s*\(\s*\)'
      type: "conversion"
    - pattern: 'MutableStateFlow\s*\('
      type: "state_flow"
    - pattern: 'MutableSharedFlow\s*\('
      type: "shared_flow"
  
  collect_patterns:
    - pattern: '(?P<flow>\w+)\.collect\s*\{'
      type: "terminal"
    - pattern: '(?P<flow>\w+)\.collectLatest\s*\{'
      type: "terminal_latest"
    - pattern: '(?P<flow>\w+)\.launchIn\s*\('
      type: "launch_in"
    - pattern: '(?P<flow>\w+)\.stateIn\s*\('
      type: "convert_to_state"
    - pattern: '(?P<flow>\w+)\.shareIn\s*\('
      type: "convert_to_shared"
  
  operators:
    - map
    - filter
    - flatMapConcat
    - flatMapMerge
    - flatMapLatest
    - debounce
    - distinctUntilChanged
    - combine
    - zip


channel:
  description: "Kotlin Channel"
  icon: "ğŸ“¬"
  
  creation_patterns:
    - pattern: 'Channel\s*<(?P<type>[^>]+)>\s*\('
    - pattern: 'produce\s*\{'
  
  send_patterns:
    - pattern: '(?P<channel>\w+)\.send\s*\('
    - pattern: '(?P<channel>\w+)\.trySend\s*\('
  
  receive_patterns:
    - pattern: '(?P<channel>\w+)\.receive\s*\(\s*\)'
    - pattern: '(?P<channel>\w+)\.tryReceive\s*\(\s*\)'
    - pattern: 'for\s*\(\s*(?P<item>\w+)\s+in\s+(?P<channel>\w+)\s*\)'

